<div th:fragment="taskList">
    <table class="table table-striped align-middle">
        <thead>
        <tr>
            <th>#</th>
            <th>Tên Task</th>
            <th>Mô tả</th>
            <th>Trạng thái</th>
            <th>Deadline</th>
            <th>Thao tác</th>
        </tr>
        </thead>
        <tbody id="task-list-tbody">
        <tr th:each="task, iterStat : ${project.tasks}" th:data-task-id="${task.id}"
            th:classappend="${task.completed} ? 'completed-row' : ''">
            <td th:text="${iterStat.count}"></td>
            <td th:text="${task.title}"
                th:classappend="${task.completed} ? 'text-decoration-line-through text-muted' : ''"></td>
            <td th:text="${task.description}"
                th:classappend="${task.completed} ? 'text-decoration-line-through text-muted' : ''"></td>
            <td class="text-center">
                <input type="checkbox"
                       class="form-check-input"
                       th:checked="${task.completed}"
                       th:attr="data-toggle-url=@{'/tasks/toggle/' + ${task.id} + '/' + ${project.id}}"
                       onchange="window.location.href = this.getAttribute('data-toggle-url');">
            </td>
            <td th:text="${task.deadline}"
                th:classappend="${task.completed} ? 'text-decoration-line-through text-muted' : ''"></td>
            <td>
                <a th:href="@{'/tasks/' + ${task.id}}" class="btn btn-info btn-sm me-1">Xem</a>
                <a href="#"
                   class="btn btn-warning btn-sm me-1"
                   th:attr="data-id=${task.id}, data-title=${task.title}, data-description=${task.description}, data-project=${project.id}, data-deadline=${task.deadline}"
                   onclick="openEditModal(this)">Sửa</a>
                <a th:href="@{'/tasks/delete/' + ${task.id} + '/' + ${project.id}}"
                   class="btn btn-danger btn-sm"
                   onclick="return confirm('Bạn có chắc muốn xóa công việc này không?');">Xóa</a>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(project.tasks)}">
            <td colspan="6" class="text-center text-muted">Chưa có công việc nào trong dự án này.</td>
        </tr>
        </tbody>
    </table>
</div>
